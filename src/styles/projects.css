/* src/styles/projects.css */

/* ==========================================================================
   0) Visibility helpers
   ========================================================================== */

/* Only show MobileSwipeCarousel on mobile */
@media (min-width: 720px) {
  .project-mobile-swipe { display: none !important; }
}

/* ==========================================================================
   1) Hero sizing (Tri card)
   ========================================================================== */

.project-tri {
  width: 100%;
  max-width: 760px;
  margin-inline: auto;
}
@media (min-width: 1620px) { .project-tri { max-width: 860px; } }
@media (min-width: 2500px) { .project-tri { max-width: 980px; } }

/* ==========================================================================
   2) Full-bleed section background
   ========================================================================== */

.project-shell--very-back { --project-section-bg: var(--very-back); }
.project-shell--dividers  { --project-section-bg: var(--color_divider); }

.project-shell .home-content-section {
  position: relative;
  overflow: visible;
}

.project-shell .home-content-section::before {
  content: "";
  position: absolute;
  top: 0;
  bottom: 0;
  left: 50%;
  width: 100vw;
  transform: translateX(-50%);
  background: var(--project-section-bg, transparent);
  z-index: 0;
}

.project-shell .home-content-section > * {
  position: relative;
  z-index: 1;
}

/* ==========================================================================
   3) Content channel centering (between nav rail + carousel rail)
   ========================================================================== */

.project-shell .project-content-inner {
  width: min(
    980px,
    calc(100vw - var(--nav-safe, 0px) - var(--carousel-safe, 0px) - 48px)
  );
  max-width: 100%;
  margin-inline: auto;

  /* Center within the nav+carousel "channel" (not the full viewport) */
  --project-nudge-x: -80px;

  transform: translateX(
    clamp(
      -120px,
      calc(
        (var(--nav-safe, 0px) - var(--carousel-safe, 0px)) / 2
        + var(--project-nudge-x)
      ),
      120px
    )
  );

  display: flex;
  flex-direction: column;
  align-items: stretch;

  gap: var(--jumbo);
  min-width: 0;
  box-sizing: border-box;
}

/* Fine-tune channel-centering by common desktop widths */
@media (max-width: 1600px) { .project-shell .project-content-inner { --project-nudge-x: -124px; } }
@media (max-width: 1450px) { .project-shell .project-content-inner { --project-nudge-x: -116px; } }
@media (max-width: 1100px) { .project-shell .project-content-inner { --project-nudge-x: -56px; } }

/* When the rail is hidden, center normally */
@media (max-width: 900px) {
  .project-shell .project-content-inner { transform: none; }
}

/* Mobile gutters */
@media (max-width: 719px) {
  .project-shell .project-content-inner {
    transform: none;
    max-width: none;
    padding-top: 56px;
    padding-bottom: 72px;
    padding-left: 18px !important;
    padding-right: 18px !important;
    box-sizing: border-box;
  }
}

/* ==========================================================================
   4) StudioTextCard constraints
   ========================================================================== */

.project-shell .project-content-inner .studio-text-card {
  width: 100%;
  max-width: min(700px, 100%);
  margin-inline: auto;
  box-sizing: border-box;
}

@media (max-width: 1100px) {
  .project-shell .project-content-inner .studio-text-card {
    max-width: min(620px, 100%);
  }
}

@media (max-width: 719px) {
  .project-shell .project-content-inner .studio-text-card {
    width: 100%;
    max-width: 520px;
    margin-inline: auto;
    transform: translateX(22px);
  }
}

@media (min-width: 1620px) {
  .project-shell .project-content-inner .studio-text-card {
    max-width: min(860px, 100%);
  }
}
@media (min-width: 2500px) {
  .project-shell .project-content-inner .studio-text-card {
    max-width: min(980px, 100%);
  }
}

/* ==========================================================================
   5) TOMY embeds (NO OVERLAP FIX)
   Key rule: transforms don't affect layout, so we reserve real space.
   IMPORTANT: set --tomy-scale on .tomy-embed (parent), not .tomy-screen (child).
   ========================================================================== */

.project-shell .project-content-inner .project-media-block {
  width: 100%;
  max-width: min(980px, 100%);
  margin-inline: auto;

  display: flex;
  flex-direction: column;

  /* spacing between the two TOMY screens */
  gap: 84px;
}

/* tablet-ish */
@media (max-width: 1100px) {
  .project-shell .project-content-inner .project-media-block {
    max-width: min(620px, 100%);
  }
}

/* mobile */
@media (max-width: 719px) {
  .project-shell .project-content-inner .project-media-block {
    max-width: 520px;
    align-items: center;
    gap: var(--md);
  }
}

/* Each TOMY embed: owns the scale variable + reserves real space */
.project-media-block .tomy-embed {
  width: 100%;
  max-width: 100%;
  display: flex;
  justify-content: center;

  overflow: visible;
  margin-inline: 0 !important;

  /* ✅ THIS is the fix: scale lives here so margin-bottom can use it */
  --tomy-scale: 1;

  /* Reserve vertical space for scaled TOMY screens (transform doesn't affect flow) */
  --tomy-space-mult: 320px; /* tweak 280–380 based on your visuals */
  margin-bottom: calc((var(--tomy-scale) - 1) * var(--tomy-space-mult));

  /* also add a little real padding so edges never kiss */
  padding-block: 28px;
}

/* Make whatever the TOMY UI renders behave responsively */
.project-media-block .tomy-embed > *,
.project-media-block .tomy-embed img,
.project-media-block .tomy-embed svg,
.project-media-block .tomy-embed canvas {
  max-width: 100% !important;
  height: auto !important;
}

/* TOMY screen scaling + optical nudge */
.project-media-block .tomy-screen {
  transform: translateX(-10px) scale(var(--tomy-scale));
  transform-origin: top center;
}

/* Scale rules (set on .tomy-embed so layout spacing updates too) */

/* Mobile: slightly smaller */
@media (max-width: 719px) {
  .project-media-block .tomy-embed {
    --tomy-scale: 0.92;
    --tomy-space-mult: 160px;
    padding-block: 16px;
  }
}

/* 1024-ish: ~20% bigger */
@media (min-width: 1000px) and (max-width: 1199px) {
  .project-media-block .tomy-embed { --tomy-scale: 1.2; }
}

/* 1440-ish: ~36% bigger */
@media (min-width: 1360px) and (max-width: 1499px) {
  .project-media-block .tomy-embed { --tomy-scale: 1.36; }
}

/* 1512-ish: ~42% bigger */
@media (min-width: 1500px) and (max-width: 1619px) {
  .project-media-block .tomy-embed { --tomy-scale: 1.42; }
}

/* Wide desktop: give card/media/card more breathing room */
@media (min-width: 1620px) {
  .project-shell .project-content-inner { gap: 180px; } /* was 260; keep it sane */
  .project-shell .project-content-inner .project-media-block { gap: 120px; }
  .project-media-block .tomy-embed { --tomy-space-mult: 60px; padding-block: 40px; }
}

/* Ultra-wide */
@media (min-width: 2000px) {

  .project-shell .project-content-inner { gap: 60px; }
  .project-shell .project-content-inner .project-media-block { gap: 30px; }
  .project-media-block .tomy-embed { --tomy-space-mult: 60px; padding-block: 56px; }
}

/* 2500+: big scale + big real spacing */
@media (min-width: 2500px) {
  .project-media-block .tomy-embed { --tomy-scale: 2; --tomy-space-mult: 200px; }
  .project-shell .project-content-inner .project-media-block { gap: 60px; }
  .project-shell .project-content-inner { gap: 60px; }
}

/* ==========================================================================
   6) Theme rules when very-back is active
   ========================================================================== */

.project-shell--very-back .studio-text-card {
  background: rgba(216, 201, 181, 0.05);
  border-color: rgba(216, 201, 181, 0.14);
}

.project-shell--very-back .studio-text-card,
.project-shell--very-back .studio-text-card__title,
.project-shell--very-back .studio-text-card__body,
.project-shell--very-back .studio-text-card__body p,
.project-shell--very-back .studio-text-card__body li {
  color: var(--it-s-white) !important;
}